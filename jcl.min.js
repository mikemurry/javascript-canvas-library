var JCL=JCL||{log:function(a){if(console){console.log(a)}},info:function(a){if(console){console.info(a)}},warn:function(a){if(console){console.warn(a)}},error:function(a){if(console){console.error(a)}}};JCL.namespace=function(c){var e,b,a,d;b=JCL;e=c.split(".");if(e[0]==="JCL"){e=e.slice(1)}d=e.length;for(a=0;a<d;a++){if(typeof b[e[a]]==="undefined"){b[e[a]]={}}b=b[e[a]]}return b};JCL.utilities={randomInt:function(b,a){if(b!==undefined&&a!==undefined){return Math.floor((a-b)*Math.random())+b}else{JCL.warn("utilities.randomInt() Error: Missing min or max argument.")}return false},radians:function(a){return(Math.PI/180)*a},degrees:function(a){return a*(180/Math.PI)},createFragment:function(d,b){var c=document.createDocumentFragment(),a=document.createElement("div");a.id=d;a.innerHTML=b;while(a.firstChild){c.appendChild(a.firstChild)}return c},bounds:function(e){var d,b,c,a;for(d=0,b=e.length;d<b;d++){if(!c){c=e[d]}if(!a){a=e[d]}if(e[d]>a){a=e[d]}if(e[d]<c){c=e[d]}}return{min:c,max:a}}};JCL.renderer=(function(){var d,a;window.requestAnimFrame=(function c(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(g){window.setTimeout(g,1000/60)}})();d=[];a=0;function f(){if(a>0){for(var g=0;g<a;g++){d[g]()}window.requestAnimFrame(f)}}function e(h){var g=d.push(h);a=g;if(a===1){f()}return g-1}function b(g){d.splice(g,1);a=d.length;return true}return{add:e,remove:b,debug:d}}());JCL.performance=(function(){var b,c,d,g,f;b=false;c=new Date();d=0;f=0;g=0;function e(){if(!b){JCL.renderer.add(a);b=true}}function a(){var h=new Date();d=(h-c)/1000;f+=d;c=h;g=Math.floor(1/d)}e();return{delta:function(){return d},elapsed:function(){return f},fps:function(){return g}}}());JCL.Canvas=function(c,a){var b=this;a=a||{};this.options=a;if(typeof c==="object"){if(c.length){this.dom=c[0]}else{this.dom=c}}else{this.dom=document.getElementById(c)}if(!this.dom){JCL.error("Invalid Canvas DOM passed into the constructor.")}else{this.ctx=this.dom.getContext("2d");this.enabled=(this.ctx!==undefined)}if(this.enabled){if(a.width){this.dom.width=a.width}if(a.height){this.dom.height=a.height}if(a.fullscreen){this.dom.width=window.innerWidth;this.dom.height=window.innerHeight}if(a.zindex){this.dom.style.zIndex=a.zindex}this.width=this.dom.width;this.height=this.dom.height;this.dom.onmousemove=function(d){if(b.rollover){b.rollover(d)}};this.dom.onmouseout=function(d){if(b.rollout){b.rollout(d)}}}else{JCL.warn("Canvas (ID: '"+c+"') cannot be enabled.")}return this};JCL.Canvas.prototype={drawRectangle:function(a){if(a.constructor===JCL.Rectangle){if(a.fillStyle){this.ctx.fillStyle=a.fillStyle;this.ctx.fillRect(Math.floor(a.x)+0.5,Math.floor(a.y)+0.5,a.width,a.height)}if(a.strokeStyle){this.ctx.strokeStyle=a.strokeStyle;this.ctx.lineWidth=a.lineWidth||1;this.ctx.strokeRect(Math.floor(a.x)+0.5,Math.floor(a.y)+0.5,a.width,a.height)}}else{JCL.warn("Cannot draw a rectangle without a JCL.Rectangle instance.")}return this},drawPath:function(b,e,a){var d=b.length,c;this.ctx.strokeStyle=e||"#000000";this.ctx.lineWidth=a||1;this.ctx.beginPath();this.ctx.moveTo(b[0].x,b[0].y);for(c=1;c<d;c++){this.ctx.lineTo(b[c].x,b[c].y)}this.ctx.stroke();return this},drawShape:function(c,b,f,a){var e=c.length,d;this.ctx.strokeStyle=f||"rgba(0,0,0,0)";this.ctx.lineWidth=a||1;this.ctx.fillStyle=b||"rgba(0,0,0,0)";this.ctx.beginPath();this.ctx.moveTo(c[0].x,c[0].y);for(d=1;d<e;d++){this.ctx.lineTo(c[d].x,c[d].y)}this.ctx.closePath();this.ctx.stroke();this.ctx.fill();return this},drawHaystack:function(b,e,a){var d=b.length,c;this.ctx.strokeStyle=e||"#000000";this.ctx.lineWidth=a||1;this.ctx.beginPath();for(c=0;c<d;c++){this.ctx.moveTo(b[c][0].x,b[c][0].y);this.ctx.lineTo(b[c][1].x,b[c][1].y)}this.ctx.stroke();return this},drawCircle:function(a){this.ctx.beginPath();this.ctx.arc(a.center.x,a.center.y,a.radius,0,Math.PI*2,false);if(a.fillStyle){this.ctx.fillStyle=a.fillStyle;this.ctx.fill()}if(a.strokeStyle){this.ctx.strokeStyle=a.strokeStyle;this.ctx.lineWidth=a.lineWidth||1;this.ctx.stroke()}return this},drawArc:function(c,b,h,d,e,g,a){var f=JCL.utilities.radians;this.ctx.beginPath();this.ctx.arc(c.x,c.y,b,f(h-90),f(d-90),false);if(e){this.ctx.fillStyle=e;this.ctx.fill()}if(g){this.ctx.strokeStyle=g;this.ctx.lineWidth=a||1;this.ctx.stroke()}return this},drawText:function(d,b,f,c,e,a){if(a){this.ctx.fillStyle=a}this.ctx.font="bold 10px sans-serif";if(c){this.ctx.textBaseline=c}if(e){this.ctx.textAlign=e}if(b){this.ctx.font=b}this.ctx.fillStyle=a||"black";this.ctx.fillText(d,f.x,f.y);return this},drawImage:function(c,b,e,d,a){this.ctx.drawImage(c,b,e,d,a);return this},drawImageExt:function(d,g,f,a,c,i,h,e,b){this.ctx.drawImage(d,g,f,a,c,i,h,e,b);return this},drawRemoteImage:function(c,b,g,e,a){var d=new Image(),f=this;d.onload=function(){f.drawImage(d,b,g,e,a)};d.src=c;return this},clearRect:function(a,d,b,c){this.ctx.clearRect(a,d,b,c);return this},clear:function(){this.ctx.clearRect(0,0,this.dom.width,this.dom.height);return this},save:function(){this.ctx.save();return this},restore:function(){this.ctx.restore();return this},translate:function(a,b){this.ctx.translate(a,b);return this},rotate:function(a){this.ctx.rotate(a);return this}};JCL.Point=function Point(a,c,b){return this.set(a,c,b)};JCL.Point.prototype={constructor:"Point",set:function(a,c,b){this.x=a||0;this.y=c||0;this.z=b||0;return this},get:function(){return{x:this.x,y:this.y,z:this.z}},toString:function(){return"Point( x:"+this.x+", y:"+this.y+", z:"+this.z+")"},distance:function(b){if(b.constructor==="Point"){return Math.sqrt(Math.pow(b.x-this.x,2)+Math.pow(b.y-this.y,2))}else{JCL.warn("Cannot calculate distance of a non-point.")}return undefined},angle:function(b){if(b.constructor==="Point"){return Math.atan2(b.y-this.y,b.x-this.x)}else{JCL.warn("Cannot calculate angle of a non-point.")}return undefined},tangent:function(b,c){var a=JCL.utilities.radians;if(b!==null&&c!==null){return new JCL.Point((c*Math.cos(a(b)))+this.x,(c*Math.sin(a(b)))+this.y)}else{JCL.warn("Could not calculate tangent. Missing required data. (Angle: "+b+", Distance: "+c+")")}return undefined},lerp:function(b,c){if(!c||c<0){c=0}else{if(c>1){c=1}}if(this&&b&&c!==null){if(b.constructor==="Point"){return{x:this.x+((b.x-this.x)*c),y:this.y+((b.y-this.y)*c)}}else{JCL.warn("Could not interpolate point. Invalid point.")}}else{JCL.warn("Could not interpolate point. Missing required data.")}return undefined},translate:function(a,d,c){var b=this.get();return this.set(b.x+(a||0),b.y+(d||0),b.z+(c||0))}};JCL.Rectangle=function(a){this.x=a.x||0;this.y=a.y||0;this.width=a.width||0;this.height=a.height||0;this.fillStyle=a.fill||null;this.strokeStyle=a.stroke||null;this.lineWidth=a.thickness||0;this.pivot=new JCL.Point(0,0)};JCL.Rectangle.prototype={get:function(){return{x:this.center.x,y:this.center.y,center:this.center,width:this.width,height:this.height,fillStyle:this.fillStyle,strokeStyle:this.strokeStyle,lineWidth:this.lineWidth}},toString:function(){return"Rectangle( x:"+this.center.x+", y:"+this.center.y+", center: "+this.center.toString()+", width:"+this.width+", height:"+this.height+", fillStyle:"+this.fillStyle+", strokeStyle:"+this.strokeStyle+", lineWidth:"+this.lineWidth+")"},center:function(a){if(a){this.set(a.x-(this.width/2),a.y-(this.height/2),a.z-(this.depth/2),this.width,this.height,this.depth);return this}else{return new JCL.Point(this.x+(this.width/2),this.y+(this.height/2),this.z+(this.depth/2))}},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.width=Math.round(this.width);this.height=Math.round(this.height);return this},render:function(a){if(a instanceof JCL.Canvas){a.drawRectangle(this)}else{JCL.error("Specified canvas is not an instance of JCL.Canvas.")}return this}};JCL.Circle=function(a){if(!a.center){this.center=new JCL.Point(a.x||0,a.y||0)}else{if(a.center instanceof JCL.Point){this.center=a.center}else{this.center=new JCL.Point(a.center.x||0,a.center.y||0)}}this.radius=a.radius||0;this.fillStyle=a.fill||null;this.strokeStyle=a.stroke||null;this.lineWidth=a.thickness||0};JCL.Circle.prototype={render:function(a){if(a instanceof JCL.Canvas){a.drawCircle(this)}else{JCL.error("Circle.render() context must be a JCL.Canvas.")}return this}};JCL.Color=function(a){if(a.hasOwnProperty("h")){this.h=a.h||0;this.s=a.s||0;this.l=a.l||0;this.toRGB(this.hsl())}else{if(a.hasOwnProperty("r")){this.r=a.r||0;this.g=a.g||0;this.b=a.b||0;this.toHSL(this.rgb())}}this.a=a.a||1;return this};JCL.Color.prototype={lerp:function(a,c){return this},toHSL:function(a,i,k){var e=a/255;var c=a/255;var l=k/255;var d=Math.max(e,c,l);var f=Math.min(e,c,l);var j=(d+f)/2;var h=0;var m=0;if(d!=f){if(j<0.5){h=(d-f)/(d+f)}else{h=(d-f)/(2-d-f)}if(e===d){m=(c-l)/(d-f)}else{if(c===d){m=2+(l-e)/(d-f)}else{m=4+(e-c)/(d-f)}}}j=j*100;h=h*100;m=m*60;if(m<0){m+=360}this.h=m;this.s=h;this.l=j;return this.hsl()},toRGB:function(f,e,a){f=(f%360)/360;var c=a<=0.5?a*(e+1):a+e-a*e;var d=a*2-c;this.r=b(f+1/3)*255;this.g=b(f)*255;this.b=b(f-1/3)*255;return this.rgb();function b(g){g=g<0?g+1:(g>1?g-1:g);if(g*6<1){return d+(c-d)*g*6}else{if(g*2<1){return c}else{if(g*3<2){return d+(c-d)*(2/3-g)*6}else{return d}}}}},hsl:function(){return{h:this.h,s:this.s,l:this.l,a:this.a}},rgb:function(){return{r:this.r,g:this.g,b:this.b,a:this.a}}};