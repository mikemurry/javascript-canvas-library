var JCL=JCL||{VERSION:"1.1.4"};JCL.utilities={randomInt:function(b,a){if(b!==undefined&&a!==undefined){return Math.floor((a-b)*Math.random())+b}else{throw new Error("utilities.randomInt() Error: Missing min or max argument.")}},radians:function(a){return(Math.PI/180)*a},degrees:function(a){return a*(180/Math.PI)},bounds:function(e){var d,b,c,a;for(d=0,b=e.length;d<b;d++){if(!c){c=e[d]}if(!a){a=e[d]}if(e[d]>a){a=e[d]}if(e[d]<c){c=e[d]}}return{min:c,max:a}}};JCL.renderer=(function(){var e,b,a;window.requestAnimFrame=(function d(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(h){window.setTimeout(h,1000/60)}})();e=[];b=0;a=false;function g(){if(b>0){for(var h=0;h<b;h++){e[h]()}window.requestAnimFrame(g)}}function f(i){var h=e.length===0;b=e.push(i);if(h){g()}return b-1}function c(h){e.splice(h,1);b=e.length;if(b<=0){a=false}return true}return{add:f,remove:c,debug:function(){return e}}}());JCL.performance=(function(){var b,c,d,h,g;b=false;c=new Date();d=0;g=0;h=0;_index=null;function e(){if(!b){_index=JCL.renderer.add(a);b=true}return this}function f(){if(b){JCL.renderer.remove(_index);b=false}return this}function a(){var i=new Date();d=(i-c)/1000;g+=d;c=i;h=Math.floor(1/d)}return{enable:function(){e();return this},disable:function(){f();d=null;g=null;c=null;h=null;return this},delta:function(){return d},elapsed:function(){return g},fps:function(){return h}}}());JCL.Canvas=function(b,a){a=a||{};this.options=a;if(typeof b==="object"){if(b.length){this.dom=b[0]}else{this.dom=b}}else{this.dom=document.getElementById(b)}if(this.dom&&this.dom.getContext){this.ctx=this.dom.getContext("2d");this.enabled=(this.ctx!==undefined)}if(this.enabled){if(a.width){this.dom.width=a.width}if(a.height){this.dom.height=a.height}if(a.zindex){this.dom.style.zIndex=a.zindex}this.width=this.dom.width;this.height=this.dom.height;this.dom.setAttribute("width",this.width);this.dom.setAttribute("height",this.height)}else{throw new ReferenceError("Could not instantiate JCL.Canvas with specified DOM element.")}return this};JCL.Canvas.prototype={draw:function(a){if(a.render){a.render(this)}return this},drawRectangle:function(a){if(a instanceof JCL.Rectangle){if(a.fillStyle){this.ctx.fillStyle=a.fillStyle;this.ctx.fillRect(Math.floor(a.x)+0.5,Math.floor(a.y)+0.5,a.width,a.height)}if(a.strokeStyle){this.ctx.strokeStyle=a.strokeStyle;this.ctx.lineWidth=a.lineWidth||1;this.ctx.strokeRect(Math.floor(a.x)+0.5,Math.floor(a.y)+0.5,a.width,a.height)}}else{throw new TypeError("Cannot draw a rectangle without a JCL.Rectangle instance.")}return this},drawPath:function(b,e,a){var d=b.length,c;this.ctx.strokeStyle=e||"#000000";this.ctx.lineWidth=a||1;this.ctx.beginPath();this.ctx.moveTo(b[0].x,b[0].y);for(c=1;c<d;c++){this.ctx.lineTo(b[c].x,b[c].y)}this.ctx.stroke();return this},drawShape:function(c,b,f,a){var e=c.length,d;this.ctx.strokeStyle=f||"rgba(0,0,0,0)";this.ctx.lineWidth=a||1;this.ctx.fillStyle=b||"rgba(0,0,0,0)";this.ctx.beginPath();this.ctx.moveTo(c[0].x,c[0].y);for(d=1;d<e;d++){this.ctx.lineTo(c[d].x,c[d].y)}this.ctx.closePath();this.ctx.stroke();this.ctx.fill();return this},drawHaystack:function(b,e,a){var d=b.length,c;this.ctx.strokeStyle=e||"#000000";this.ctx.lineWidth=a||1;this.ctx.beginPath();for(c=0;c<d;c++){this.ctx.moveTo(b[c][0].x,b[c][0].y);this.ctx.lineTo(b[c][1].x,b[c][1].y)}this.ctx.stroke();return this},drawCircle:function(a){this.ctx.beginPath();this.ctx.arc(a.center.x,a.center.y,a.radius,0,Math.PI*2,false);if(a.fillStyle){this.ctx.fillStyle=a.fillStyle;this.ctx.fill()}if(a.strokeStyle){this.ctx.strokeStyle=a.strokeStyle;this.ctx.lineWidth=a.lineWidth||1;this.ctx.stroke()}return this},drawCircles:function(e){var b,a,d,c;if(e.length>0){c=e[0];this.ctx.beginPath();a=e.length;for(b=0;b<a;b++){d=e[b];this.ctx.moveTo(d.center.x,d.center.y);this.ctx.arc(d.center.x,d.center.y,d.radius,0,Math.PI*2,false)}if(c.fillStyle){this.ctx.fillStyle=c.fillStyle;this.ctx.fill()}if(c.strokeStyle){this.ctx.strokeStyle=c.strokeStyle;this.ctx.lineWidth=c.lineWidth||1;this.ctx.stroke()}}return this},drawArc:function(a){var b=JCL.utilities.radians;this.ctx.beginPath();this.ctx.arc(a.center.x,a.center.y,a.radius,b(a.start-90),b(a.end-90),false);if(a.fillStyle){this.ctx.fillStyle=a.fillStyle;this.ctx.fill()}if(a.strokeStyle){this.ctx.strokeStyle=a.strokeStyle;this.ctx.lineWidth=a.lineWidth||1;this.ctx.stroke()}return this},drawOval:function(b){var c,a,d;c=0.5522848;a=(b.width/2)*c;d=(b.height/2)*c;this.ctx.beginPath();this.ctx.moveTo(b.start.x,b.mid.y);this.ctx.bezierCurveTo(b.start.x,b.mid.y-d,b.mid.x-a,b.start.y,b.mid.x,b.start.y);this.ctx.bezierCurveTo(b.mid.x+a,b.start.y,b.end.x,b.mid.y-d,b.end.x,b.mid.y);this.ctx.bezierCurveTo(b.end.x,b.mid.y+d,b.mid.x+a,b.end.y,b.mid.x,b.end.y);this.ctx.bezierCurveTo(b.mid.x-a,b.end.y,b.start.x,b.mid.y+d,b.start.x,b.mid.y);this.ctx.closePath();if(b.fillStyle){this.ctx.fillStyle=b.fillStyle;this.ctx.fill()}if(b.strokeStyle){this.ctx.strokeStyle=b.strokeStyle;this.ctx.lineWidth=b.lineWidth||1;this.ctx.stroke()}return this},drawText:function(d,b,f,c,e,a){if(a){this.ctx.fillStyle=a}this.ctx.font="bold 10px sans-serif";if(c){this.ctx.textBaseline=c}if(e){this.ctx.textAlign=e}if(b){this.ctx.font=b}this.ctx.fillStyle=a||"black";this.ctx.fillText(d,f.x,f.y);return this},drawImage:function(c,b,e,d,a){this.ctx.drawImage(c,b,e,d,a);return this},drawImageExt:function(d,g,f,a,c,i,h,e,b){this.ctx.drawImage(d,g,f,a,c,i,h,e,b);return this},drawRemoteImage:function(c,b,g,e,a){var d=new Image(),f=this;d.onload=function(){f.drawImage(d,b,g,e,a)};d.src=c;return this},clearRect:function(a,d,b,c){this.ctx.clearRect(a,d,b,c);return this},clear:function(){this.ctx.clearRect(0,0,this.dom.width,this.dom.height);return this},save:function(){this.ctx.save();return this},restore:function(){this.ctx.restore();return this},translate:function(a,b){this.ctx.translate(a,b);return this},rotate:function(a){this.ctx.rotate(a);return this}};JCL.Point=function(a,b){if(arguments.length===1){b=a.y||0;a=a.x||0}return this.set(a,b)};JCL.Point.prototype={set:function(a,b){this.x=a||this.x||0;this.y=b||this.y||0;return this},toJSON:function(){return{x:this.x,y:this.y}},distance:function(b){if(b instanceof JCL.Point){return Math.sqrt(Math.pow(b.x-this.x,2)+Math.pow(b.y-this.y,2))}else{throw new TypeError("Cannot calculate distance of a non-point.")}},angle:function(b){if(b instanceof JCL.Point){return Math.atan2(b.y-this.y,b.x-this.x)}else{throw new TypeError("Cannot calculate angle of a non-point.")}},tangent:function(b,c){var a=JCL.utilities.radians;if(b!==null&&c!==null){return new JCL.Point((c*Math.cos(a(b)))+this.x,(c*Math.sin(a(b)))+this.y)}else{throw new Error("Could not calculate tangent. Missing required data. (Angle: "+b+", Distance: "+c+")")}},lerp:function(b,c){if(!c||c<0){c=0}else{if(c>1){c=1}}if(this&&b&&c!==null){if(b instanceof JCL.Point){return{x:this.x+((b.x-this.x)*c),y:this.y+((b.y-this.y)*c)}}else{throw new Error("Could not interpolate point. Invalid point.")}}else{throw new Error("Could not interpolate point. Missing required data.")}},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},crisp:function(){this.round().translate(-0.5,-0.5);return this},translate:function(a,c,b){if(b){return new JCL.Point(this.x+(a||0),this.y+(c||0))}return this.set(this.x+(a||0),this.y+(c||0))}};JCL.Rectangle=function(a){a=a||{};this.x=a.x||0;this.y=a.y||0;this.width=a.width||0;this.height=a.height||0;this.fillStyle=a.fill||null;this.strokeStyle=a.stroke||null;this.lineWidth=a.thickness||0;return this};JCL.Rectangle.prototype={set:function(b,d,c,a){this.x=b||this.width||0;this.y=d||this.y||0;this.width=c||this.width||0;this.height=a||this.height||0;return this},center:function(a){if(a){this.set(a.x-(this.width/2),a.y-(this.height/2));return this}else{return new JCL.Point(this.x+(this.width/2),this.y+(this.height/2))}},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.width=Math.round(this.width);this.height=Math.round(this.height);return this},render:function(a){if(a instanceof JCL.Canvas){a.drawRectangle(this)}else{JCL.error("Specified canvas is not an instance of JCL.Canvas.")}return this}};JCL.Circle=function(a){a=a||{};if(!a.center){this.center=new JCL.Point(a.x||0,a.y||0)}else{if(a.center instanceof JCL.Point){this.center=a.center}else{this.center=new JCL.Point(a.center.x||0,a.center.y||0)}}this.radius=a.radius||0;this.fillStyle=a.fill||null;this.strokeStyle=a.stroke||null;this.lineWidth=a.thickness||0;return this};JCL.Circle.prototype={render:function(a){if(a instanceof JCL.Canvas){a.drawCircle(this)}else{throw new TypeError("JCL.Circle.render() must be passed a JCL.Canvas.")}return this}};JCL.Arc=function(a){a=a||{};if(!a.center){this.center=new JCL.Point(a.x||0,a.y||0)}else{if(a.center instanceof JCL.Point){this.center=a.center}else{this.center=new JCL.Point(a.center.x||0,a.center.y||0)}}this.radius=a.radius||0;this.fillStyle=a.fill||null;this.strokeStyle=a.stroke||null;this.lineWidth=a.thickness||0;this.start=a.start||0;this.end=a.end||360};JCL.Arc.prototype={render:function(a){if(a instanceof JCL.Canvas){a.drawArc(this)}else{throw new TypeError("JCL.Arc.render() must be passed a JCL.Canvas.")}return this}};JCL.Oval=function(a){a=a||{};this.x=a.x||0;this.y=a.y||0;this.width=a.width||0;this.height=a.height||0;this.fillStyle=a.fill||null;this.strokeStyle=a.stroke||null;this.lineWidth=a.thickness||0;this.calculate();return this};JCL.Oval.prototype={calculate:function(){this.start=new JCL.Point(this.x,this.y);this.end=new JCL.Point(this.x+this.width,this.y+this.height);this.mid=new JCL.Point((this.x+this.width)/2,(this.y+this.height)/2);return this},center:function(a){if(a){this.x=a.x-(this.width/2);this.y=a.y-(this.height/2);this.calculate();return this}else{return new JCL.Point(this.x+(this.width/2),this.y+(this.height/2))}},render:function(a){if(a instanceof JCL.Canvas){a.drawOval(this)}else{JCL.error("Specified canvas is not an instance of JCL.Canvas.")}return this}};