<!DOCTYPE html>
<html>
<head>
    <title></title>
    <style>
        body {
            background: #efefef;
        }
        canvas {
            background: #fff;
            display: block;
            margin: 20px auto;
        }
    </style>
</head>
<body>

<canvas id="canvas" width="800" height="600"></canvas>

<script src="../../jcl.js"></script>
<script src="../../lib/jcl.VectorPoint.js"></script>
<script src="../../lib/jcl.Particle.js"></script>

<script>

    var canvas = new JCL.Canvas('canvas');

    var particle = new JCL.Particle({
        position: new JCL.Point(0, 300)
    });

    var circle = new JCL.Circle({
        x: particle.position.x,
        y: particle.position.y,
        radius: 15,
        stroke: '#000',
        fill: '#ccc',
        thickness: 2
    });

    var repulsors = [];

    for (var i=0; i<5; i++) {
        repulsors.push(new JCL.Circle({
            x: Math.random() * 800,
            y: Math.random() * 600,
            radius: 10,
            stroke: '#000',
            fill: 'red',
            thickness: 2
        }))
    }

    var attractors = [];

    for (var i=0; i<5; i++) {
        attractors.push(new JCL.Circle({
            x: Math.random() * 800,
            y: Math.random() * 600,
            radius: 10,
            stroke: '#000',
            fill: 'green',
            thickness: 2
        }))
    }

    JCL.performance.enable();

    //particle.velocity = new JCL.Point(10,0);
    //particle.force = new JCL.VectorPoint(100,40);

    JCL.renderer.add(function() {

        canvas.clear();

        var repulsor, distance;

        particle.force.scale(0);

        for (var i=0; i<repulsors.length; i++) {
            repulsor = repulsors[i];
            distance =
            repulsors[i].render(canvas);
            particle.force.add(new JCL.VectorPoint(repulsors[i].center.x - particle.position.x, repulsors[i].center.y - particle.position.y).scale(-1));
        }

        for (var i=0; i<repulsors.length; i++) {
            attractors[i].render(canvas);
            particle.force.add(new JCL.VectorPoint(attractors[i].center.x - particle.position.x, attractors[i].center.y - particle.position.y));
        }

        //particle.force.add(new JCL.Point(400 - particle.position.x, 300 - particle.position.y)).normalize().scale(1000);

        if (particle.force.length() > 100) {
            //particle.force.normalize().scale(100);
        }

        particle.update(JCL.performance.delta());

        circle.center.x = particle.position.x;
        circle.center.y = particle.position.y;

        canvas.drawCircle(circle);

        // Draw Force Indication
        canvas.drawPath([circle.center, particle.force.clone().add(circle.center)], 'rgb(30,255,30)', 2);


    });

</script>

</body>
</html>